[
  {
    "path": "posts/2021-06-12-building-distill/",
    "title": "Building a {distill} website",
    "description": "How I built this site using {distill}",
    "author": [
      {
        "name": "dondon",
        "url": {}
      }
    ],
    "date": "2021-06-12",
    "categories": [],
    "contents": "\r\nHere is where I will talk about building this website.\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-06-12-building-distill/image1.png",
    "last_modified": "2021-06-12T18:49:56+09:00",
    "input_file": {},
    "preview_width": 1863,
    "preview_height": 834
  },
  {
    "path": "posts/2021-06-12-nonparametric-regression/",
    "title": "Nonparametric Regression",
    "description": {},
    "author": [
      {
        "name": "dondon",
        "url": {}
      }
    ],
    "date": "2021-01-05",
    "categories": [
      "statistics",
      "R"
    ],
    "contents": "\r\n\r\nContents\r\nNon-parametric regression concept\r\nRegressogram\r\nExample\r\nKernel estimator\r\n\r\n\r\nNon-parametric regression concept\r\n비모수 회귀분석은 함수의 형태를 가정하지 않는 회귀모형을 의미한다. 모수적 회귀모형에서는 보통 \\(Y = \\beta_0 + \\beta_1X_1 + ... + \\beta_pX_p + \\epsilon\\) 형태의 선형성을 가정했다(모수적 회귀모형에는 선형성을 가정하지 않는 비선형 회귀모형도 포함된다).\r\n반면에 비모수 회귀모형에서는 고정된 함수의 형태를 가정하지 않고 단순히 smooth function을 가정한다.\r\n표본 (X_1,Y_1), …(X_n,Y_n)이 주어졌을 때 우리가 추정하고자 하는 회귀 함수는 다음과 같이 정의된다.\r\n\\[\r\nY = m(X) + \\epsilon, \\quad m(x) = E(Y|X = x), \\quad E(\\epsilon) = 0\r\n\\]\r\nRegressogram\r\n가장 단순한 비모수추정치는 regressogram이다.\r\n논의의 편의를 위해 설명변수를 1개만 가정한다. 또한 X는 0과 1사이의 값을 갖는다고 가정한다.\r\n먼저 \\([0, 1]\\) 구간을 k개의 bin으로 쪼갠다. 쪼갠 각 구간에 포함되는 관측치의 갯수를 계산한다.\r\n\\[B_1 = [0, h], \\quad B_2= [h, 2h], ...  \\] \\(n_j\\) : \\(B_j\\)에 포함되는 관측치의 갯수 \\(n_j = \\sum_{i}I(X_i \\in B_j), \\quad I(X_i \\in B_j) = \\begin{cases} 1, & \\mbox{if }\\mbox{X가 B_j에 포함될 경우} \\\\ 0, & \\mbox{if }n\\mbox{ X가 B_j에 포함되지 않을 경우} \\end{cases}\\)\r\n\\(B_j\\) 구간에서의 \\(Y_i\\)들의 평균 \\(\\bar{Y}_j\\)는 다음과 같이 정의된다.\\[\\bar{Y}_j = \\frac{1}{n_j} \\sum_{X_i \\in B_j} Y_i\\]\r\n마지막으로 \\(\\hat{m}(x)\\)는 모든 \\(B_j\\)구간에서의 \\(\\bar{Y}_j\\)의 합으로 정의된다. \\[\\hat{m}(x) = \\sum_{j = 1}^k \\bar{Y_j}I(x \\in B_j)\\]\r\nExample\r\n\\(Y_i = sin(X_i) + \\epsilon\\)라는 모형에서 생성한 50개의 자료이다. 이 경우 \\(m(x) = sin(x)\\)이고 \\(X_i \\sim U(-2, 2)\\), \\(\\epsilon_i \\sim N(0, \\frac{1}{9})\\)이다.\r\n\r\n\r\nn = 50\r\nset.seed(1233)\r\nx = runif(n, -2, 2)\r\ny = sin(x)+rnorm(n, mean = 0, sd = 1/3)\r\n\r\n\r\n\r\n구간의 갯수 k를 어떻게 지정하는지에 따라 \\(\\hat{m}(x)\\)는 undersmooth될 수도 있고 oversmooth될 수도 있다. 따라서 적절한 k를 지정하는 것이 중요하다(뒤에 cross-validation 참고).\r\n\r\n\r\nrunning_mean = function(x,y,left,right,k){\r\n        n = length(x)\r\n        B = seq(left,right,length=k+1)\r\n        # 어떤 값이 구간에 있을 때 어느 구간에 속할지 알려주는 함수NAWhichBin = findInterval(x,B)  \r\n        # 각 구간에 포함되어 있는 관측치의 갯수NAN = tabulate(WhichBin)  \r\n        m.hat = rep(0,k)\r\n        for(j in 1:k){\r\n                if(N[j]>0) m.hat[j] = mean(y[WhichBin == j])\r\n        }\r\n        return(list(bins=B,m.hat=m.hat))\r\n}\r\n\r\n\r\n\r\n\r\n\r\nfit_10 <- running_mean(x, y, left = -2, right = 2, k = 10)\r\nfit_30 <- running_mean(x, y, left = -2, right = 2, k = 30)\r\ndata.frame(x,y) %>% ggplot(aes( x = x, y = y)) +\r\n        geom_point() + \r\n        geom_line(data = data.frame(x = x, y = sin(x)), aes(x = x, y = y)) +  \r\n        geom_line(data = data.frame(x = fit_10$bins, y = c(fit_10$m.hat, fit_10$m.hat[10])),\r\n                  aes(x =x, y = y),\r\n                  color = 'red')+\r\n         geom_line(data = data.frame(x = fit_30$bins, y = c(fit_30$m.hat, fit_30$m.hat[30])), \r\n                  aes(x = x, y = y), \r\n                  color = 'blue') + \r\n        ylim(c(-2, 2))\r\n\r\n\r\n\r\n\r\n\r\n\r\nHoRM::regressogram(x = x, y = y, nbins = 10, show.bins = T, show.lines = T, show.means = F, main = 'regressogram')\r\n\r\n\r\n\r\n\r\n\\(k = 10\\)일 때 red line을 보면 적절하게 추정된 것으로 보인다. \\(k = 30\\)일 때 blue line을 보면 oversmooth된 것처럼 보인다.\r\nKernel estimator\r\n커널 추정법은 회귀함수 \\(f\\)의 추정치 \\(\\hat{f}\\)가 \\(\\mathbf{y} = (Y_1, Y_2, ..., Y_n)^t\\)의 선형결합으로 표현된다는 전제 하에서 출발한다. 즉, \\(\\hat{f}(x) = \\sum w_iY_i\\)으로 추정하고자 하는데 가중치 \\(w_i\\)를 어떻게 정해주는지가 핵심이다.\r\n이어서 정리 예정\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-06-12-nonparametric-regression/nonparametric-regression_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2021-06-12T20:28:25+09:00",
    "input_file": "nonparametric-regression.knit.md",
    "preview_width": 1248,
    "preview_height": 768
  }
]
